<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>🤖 BeliveHome AI 助手</title>
  <style>
    body { font-family: sans-serif; background:#f9f9f9; padding:30px; }
    .box { max-width:600px; margin:auto; background:#fff; padding:20px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    input { width:70%; padding:10px; border:1px solid #ccc; border-radius:6px; }
    button { padding:10px 16px; background:#4CAF50; border:none; color:white; border-radius:6px; cursor:pointer; }
    button:hover { background:#45a049; }
    pre { margin-top:15px; padding:12px; background:#fafafa; border:1px solid #ddd; border-radius:6px; white-space:pre-wrap; }
  </style>
</head>
<body>
  <div class="box">
    <h3>🤖 BeliveHome AI 助手</h3>
    <input id="q" placeholder="请输入问题…" />
    <button onclick="ask()">发送</button>
    <pre id="out"></pre>
  </div>

  <script>
  async function ask() {
    const q = document.getElementById('q').value;
    const out = document.getElementById('out');
    out.textContent = "⏳ 查询中…";

    try {
      const r = await fetch('/api/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: q })
      });

      const data = await r.json();

      if (data.reply) {
        out.innerHTML = data.reply.replace(/\n/g,'<br>');
      } else {
        // 显示完整报错
        out.textContent = "❌ " + JSON.stringify(data, null, 2);
      }
    } catch (e) {
      out.textContent = "❌ 出错: " + e.message;
    }
  }
  </script>
</body>
</html>
